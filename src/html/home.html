<!doctype html>
<html lang="en">
  <head>
    {% include "_metadata.html" %}
    <link rel="stylesheet" href="public/styles/home.css" />
  </head>
  <body>
    {% include "_navbar.html" %}
    {% include "_notification.html" %}

    <div class="main-container">
      {% for meme in memes %}
      <div class="meme-container">
        <img class="meme" src="{{ meme.image_url }}" alt="memelibre" loading="lazy" />
        <button onclick="sharePage()">ðŸ”— Share</button>
      </div>
      {% endfor %}

      <div class="pagination">
        {% if prev_cursor %}
            <a href="/?before={{ prev_cursor }}">Previous Page</a>
        {% endif %}

        {% if memes | length == 100 and next_cursor %}
            <a href="/?after={{ next_cursor }}">Next Page</a>
        {% endif %}
      </div>
    </div>
  </body>

  <script>
  function sharePage() {
    const notificationContainer = document.getElementById("notification-container");
    const notification = document.getElementById("notification");

    if (navigator.share) {
      navigator.share({
        title: document.title,
        text: 'Check this out!',
        url: window.location.href,
      }).catch(() => {});
    } else {
      navigator.clipboard.writeText(window.location.href)
        .then(() => {
          notificationContainer.style.display = "block";
          notification.textContent = "Link copied to clipboard!";

          setTimeout(() => {
          notificationContainer.style.display = "none";
          }, 3000);
        })
        .catch(err => {
          notificationContainer.style.display = "block";
          notification.textContent = "Failed to copy link.";

          setTimeout(() => {
          notificationContainer.style.display = "none";
          }, 3000);

          console.error("Clipboard error:", err);
        });
    }
  }
</script>
</html>

